(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{457:function(t,e,s){t.exports=s.p+"assets/img/AuthEndpointFlow.db794f72.jpg"},532:function(t,e,s){"use strict";s.r(e);var a=s(48),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"authentication-endpoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authentication-endpoint"}},[t._v("#")]),t._v(" Authentication Endpoint")]),t._v(" "),a("p",[t._v("Production based installation will require you to implement an authentication endpoint.\nThe goal of the endpoint is to authorize a specific user so that the skills display and skills reporting can be properly secured.")]),t._v(" "),a("p",[a("strong",[t._v("Why the need for this endpoint?")]),a("br"),t._v("\nRather than using an API to build displays, the SkillTree platform provides fully navigable "),a("strong",[t._v("Ranking and Visualization views")]),t._v("\nthat are directly embeddable into a web-based application. These "),a("strong",[t._v("Ranking and Visualization views")]),t._v(" need a way\nto authorize a user so only data for that user is loaded and shared in those UI components. To address this issue\nSkillTree utilizes the "),a("a",{attrs:{href:"https://auth0.com/docs/protocols/oauth2",target:"_blank",rel:"noopener noreferrer"}},[t._v("OAuth2"),a("OutboundLink")],1),t._v(" protocol to retrieve a temporary client token\nwhich is then used to identify that user. This backend "),a("em",[t._v("Authentication Endpoint")]),t._v(" completes "),a("a",{attrs:{href:"https://auth0.com/docs/protocols/oauth2",target:"_blank",rel:"noopener noreferrer"}},[t._v("OAuth2"),a("OutboundLink")],1),t._v(" integration for your project.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Please Note")]),t._v(" "),a("p",[a("strong",[t._v("Without")]),t._v(" implementing this endpoint authentication secrets would be exposed"),a("br"),t._v("\nin the browser and anyone could then make requests on the behalf of any user.")])]),t._v(" "),a("p",[t._v("To properly secure authentication secrets the following flow is utilized:")]),t._v(" "),a("p",[a("img",{attrs:{src:s(457),alt:"Auth Endpoint Flow"}})]),t._v(" "),a("ol",[a("li",[t._v("SkillTree "),a("RouterLink",{attrs:{to:"/skills-client/"}},[t._v("Client Library")]),t._v(" is loaded in a browser")],1),t._v(" "),a("li",[t._v("SkillTree "),a("RouterLink",{attrs:{to:"/skills-client/"}},[t._v("Client Library")]),t._v(" requests a user token from "),a("em",[t._v("Your App Backend Server")]),t._v(".")],1),t._v(" "),a("li",[a("em",[t._v("Your App Backend Server")]),t._v(" uses the project's "),a("code",[t._v("Client ID")]),t._v(" and "),a("code",[t._v("Client Secret")]),t._v(" to obtain the user's temporary token (on behalf of this user) from the SkillTree backend server. This temporary token is then sent back to the SkillTree client library (running in the browser).\n"),a("ul",[a("li",[t._v("Your project's "),a("code",[t._v("Client ID")]),t._v(" and "),a("code",[t._v("Client Secret")]),t._v(" are "),a("strong",[t._v("never")]),t._v(" exposed to the user. To ensure the safety of these credentials, they must only to be securely available to your back-end application server")]),t._v(" "),a("li",[a("code",[t._v("Client ID")]),t._v(" and "),a("code",[t._v("Client Secret")]),t._v(" come from the SkillTree dashboard under "),a("code",[t._v("Project -> Access -> 'Trusted Client Properties'")])])])]),t._v(" "),a("li",[t._v("Your JS code then uses the SkillTree "),a("RouterLink",{attrs:{to:"/skills-client/"}},[t._v("Client Library")]),t._v(" to load Ranking and Visualizations ("),a("RouterLink",{attrs:{to:"/skills-client/#skills-display-integration"}},[t._v("Skills Display")]),t._v(" Component) and to "),a("RouterLink",{attrs:{to:"/skills-client/#report-events-integration"}},[t._v("report skill events")]),t._v(" to the SkillTree backend server.\n"),a("ul",[a("li",[t._v("To identify the user securely and accurately SkillTree "),a("RouterLink",{attrs:{to:"/skills-client/"}},[t._v("Client Library")]),t._v(" sends the token obtained in steps 2-3 as an HTTP Header with each request.")],1)])],1)]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Please note that the SkillTree platform simply requires you to implement this authentication endpoint and then reference it when the JS client library is initialized.\nThe rest of the workflow is taken care of by the library (ex. display of the fully navigable visualizations and skill event reporting JS methods).")]),t._v(" "),a("p",[t._v("We provide an example of the authentication endpoint implementation below. A full working example can also be found by following the "),a("a",{attrs:{href:"https://code.nsa.gov/skills-docs/dashboard/install-guide/quickStart.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Quick Start"),a("OutboundLink")],1),t._v(" section.")])]),t._v(" "),a("h2",{attrs:{id:"implementing-authentication-endpoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#implementing-authentication-endpoint"}},[t._v("#")]),t._v(" Implementing Authentication Endpoint")]),t._v(" "),a("p",[t._v("The authentication endpoint produces a user specific temporary client token by utilizing a project's "),a("code",[t._v("Client ID")]),t._v(" and "),a("code",[t._v("Client Secret")]),t._v("\n(found in the dashboard under "),a("code",[t._v("Project -> Access -> 'Trusted Client Properties'")]),t._v(" )")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Reminder")]),t._v(" "),a("p",[t._v("Friendly reminder that you "),a("em",[a("strong",[t._v("must")])]),t._v(" keep "),a("code",[t._v("Client ID")]),t._v(" and "),a("code",[t._v("Client Secret")]),t._v(" protected/hidden/private as it serves as the\nproject's authorization mechanism. That is why these attributes must only be used within your server-side endpoint so they can\nstay protected.")])]),t._v(" "),a("p",[t._v("To retrieve a temporary client token skill, the dashboard provides a "),a("code",[t._v("/oauth/token")]),t._v(" endpoint and expects the following parameters:")]),t._v(" "),a("ol",[a("li",[t._v("Auth Param: "),a("code",[t._v("Client Id")]),t._v(" (from skills dashboard)")]),t._v(" "),a("li",[t._v("Auth Param: "),a("code",[t._v("Client Secret")]),t._v(" (from skills dashboard)")]),t._v(" "),a("li",[t._v("Data Variable Asking for client credentials:  "),a("code",[t._v("grant_type=client_credentials")]),t._v(" (can be hardcoded)")]),t._v(" "),a("li",[t._v("Data Variable specifies which user to retrieve credentials for: "),a("code",[t._v("proxy_user=<user name>")]),t._v(" (specific to user that client display is being loaded for)")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Reminder")]),t._v(" "),a("p",[t._v("Remember, your own /authentication endpoint implementation is making the request to the dashboard's "),a("code",[t._v("/oauth/token")]),t._v(" endpoint")])]),t._v(" "),a("p",[t._v("This is an implementation of the OAuth2 protocol to retrieve a temporary client token. To learn more about OAuth2 here are a couple of resources:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://auth0.com/docs/protocols/oauth2",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://auth0.com/docs/protocols/oauth2"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://oauth.net/2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://oauth.net/2/"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("Below are a number of examples of how you could implement an authentication endpoint that will be utilized by the client display.")]),t._v(" "),a("h3",{attrs:{id:"spring-boot-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-example"}},[t._v("#")]),t._v(" Spring Boot Example")]),t._v(" "),a("p",[t._v("Here is a working example of a REST endpoint within a Spring Boot application:")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@CrossOrigin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users/{user}/token"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserAuthToken1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PathVariable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this is the SkillTree dashboard endpoint that will provide your client token")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceTokenUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dashboardUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/oauth/token"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. auth param: client id")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" clientId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clientId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. auth param: client secret")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" clientSecret "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("secret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MultiValueMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LinkedMultiValueMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. Data Variable Asking for client credentials")]),t._v("\n        body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grant_type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"client_credentials"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4. Data Variable specifies which user to retrieve credentials for")]),t._v("\n        body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"proxy_user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),t._v(" oAuthRestTemplate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oAuthRestTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInterceptors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("asList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BasicAuthenticationInterceptor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("clientId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clientSecret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpHeaders")]),t._v(" headers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpHeaders")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setContentType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MediaType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("APPLICATION_FORM_URLENCODED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" responseEntity "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oAuthRestTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("postForEntity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceTokenUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpEntity")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" responseEntity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"curl-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#curl-example"}},[t._v("#")]),t._v(" CURL Example")]),t._v(" "),a("p",[t._v("Here is an example using CURL (please substitute your values of "),a("code",[t._v("client-id")]),t._v(", "),a("code",[t._v("client-secret")]),t._v(", "),a("code",[t._v("dashboard-url")]),t._v(" and "),a("code",[t._v("user-to-proxy-for")]),t._v("):")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" client-id:client-secret@dashboard-url/oauth/token -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grant_type=client_credentials&proxy_user=user-to-proxy-for"')]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);